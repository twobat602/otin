local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

local Window = WindUI:CreateWindow({
    Title = "99 Nights",
    ToggleKey = Enum.KeyCode.C,
    Icon = "cat",
    Author = "Twobat",
    Folder = "MyTestHub",

Size = UDim2.fromOffset(400, 300),
    Transparent = true,
    Theme = "Dark",
    Resizable = true,
    SideBarWidth = 200,
    BackgroundImageTransparency = 0.42,
    HideSearchBar = false,
    ScrollBarEnabled = true
})

Window:Tag({
    Title = "V1.0",
    Color = Color3.fromHex("#fa0a42")
})

Window:Tag({
    Title = "Free",
    Color = Color3.fromHex("#30ff6a")
})

--TAB

local Main = Window:Tab({
    Title = "Main",
    Icon = "house",
    Locked = false,
})

local Collect = Window:Tab({
    Title = "Collect",
    Icon = "box",
    Locked = false,
})

local Combat = Window:Tab({
    Title = "Combat",
    Icon = "box",
    Locked = false,
})


local Setting = Window:Tab({
    Title = "Setting",
    Icon = "settings",
    Locked = false,
})

local Report = Window:Tab({
    Title = "Found Bugs?",
    Icon = "bug",
    Locked = false,
})

local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local rootPart = character:WaitForChild("HumanoidRootPart")

local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local camera = workspace.CurrentCamera


-- WalkSpeed Slider
local Slider = Main:Slider({
    Title = "WalkSpeed",
    Step = 1,
    Value = {
        Min = 16,    -- bawal bumaba sa 16
        Max = 120,   -- maximum walk speed
        Default = 16, -- default walk speed
    },
    Callback = function(value)
        if humanoid then
            humanoid.WalkSpeed = value
        end
    end
})

-- JumpPower Slider
local Slider = Main:Slider({
    Title = "JumpPower",
    Step = 1,
    Value = {
        Min = 50,    -- bawal bumaba sa 50
        Max = 200,   -- maximum jump power
        Default = 50, -- default jump power
    },
    Callback = function(value)
        if humanoid then
            humanoid.UseJumpPower = true
            humanoid.JumpPower = value
        end
    end
})

local UnliJump = false
local player = game.Players.LocalPlayer
local humanoid

-- Re-assign humanoid sa respawn
local function setupHumanoid(h)
    humanoid = h
end

if player.Character then
    setupHumanoid(player.Character:WaitForChild("Humanoid"))
end

player.CharacterAdded:Connect(function(char)
    setupHumanoid(char:WaitForChild("Humanoid"))
end)

-- Toggle para sa Infinite Jump
local Toggle = Main:Toggle({
    Title = "Unli Jump",
    Desc = "Jump anytime, even in air",
    Icon = "badge-check",
    Type = "Checkbox",
    Default = false,
    Callback = function(state)
        UnliJump = state
    end
})

-- Infinite Jump Script
game:GetService("UserInputService").JumpRequest:Connect(function()
    if UnliJump and humanoid then
        humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
    end
end)

local RunService = game:GetService("RunService")
local player = game.Players.LocalPlayer
local NoClip = false

-- Character references
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- Update character references on respawn
player.CharacterAdded:Connect(function(char)
    character = char
    humanoidRootPart = char:WaitForChild("HumanoidRootPart")
end)

-- Noclip toggle
local Toggle = Main:Toggle({
    Title = "Noclip",
    Desc = "Pass through walls",
    Icon = "badge-check",
    Type = "Checkbox",
    Default = false,
    Callback = function(state)
        NoClip = state
    end
})
-- Loop para sa Noclip
RunService.RenderStepped:Connect(function()
    if NoClip and character then
        for _, part in ipairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
end)


-- Flying variables
local flying = false
local bodyVelocity
local bodyGyro

-- Fly speed variables
local targetFlySpeed = 70
local currentFlySpeed = 70

-- NoClip toggle
local NoClip = false
local teleporting = false

-- Update character references on respawn
player.CharacterAdded:Connect(function(char)
    character = char
    rootPart = character:WaitForChild("HumanoidRootPart")
    humanoid = character:WaitForChild("Humanoid")
end)

-- Functions
local function startFlying()
    if flying or not rootPart then return end
    flying = true

    bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
    bodyVelocity.Velocity = Vector3.new(0,0,0)
    bodyVelocity.Parent = rootPart

    bodyGyro = Instance.new("BodyGyro")
    bodyGyro.MaxTorque = Vector3.new(9e9,9e9,9e9)
    bodyGyro.CFrame = camera.CFrame
    bodyGyro.Parent = rootPart
end

local function stopFlying()
    if not flying then return end
    flying = false
    if bodyVelocity then bodyVelocity:Destroy(); bodyVelocity=nil end
    if bodyGyro then bodyGyro:Destroy(); bodyGyro=nil end
end

-- Flying & NoClip update loop
RunService.RenderStepped:Connect(function()
    if not rootPart or not character then return end

    -- NoClip
    if NoClip then
        for _, part in ipairs(character:GetDescendants()) do
            if part:IsA("BasePart") and part.CanCollide then
                part.CanCollide = false
            end
        end
    end

    -- Fly
    if flying and bodyVelocity and bodyGyro then
        currentFlySpeed = currentFlySpeed + (targetFlySpeed - currentFlySpeed) * 0.1

        local direction = Vector3.new()
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then direction += camera.CFrame.LookVector*currentFlySpeed end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then direction += camera.CFrame.LookVector*-currentFlySpeed end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then direction += camera.CFrame.RightVector*-currentFlySpeed end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then direction += camera.CFrame.RightVector*currentFlySpeed end
        if UserInputService:IsKeyDown(Enum.KeyCode.Space) then direction += Vector3.new(0,currentFlySpeed,0) end
        if UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then direction += Vector3.new(0,-currentFlySpeed,0) end

        bodyVelocity.Velocity = direction
        bodyGyro.CFrame = CFrame.new(rootPart.Position, rootPart.Position + camera.CFrame.LookVector)
    end
end)

-- Fly toggle
local Toggle = Main:Toggle({
    Title = "Fly",
    Desc = "Allow this so you can fly",
    Icon = "badge-check",
    Type = "Checkbox",
    Default = false,
    Callback = function(state)
        if state then
            startFlying()
        else
            stopFlying()
        end
    end
})
Toggle:Lock()
-- Fly speed slider
local Slider = Main:Slider({
    Title = "Fly Speed",
    Step = 1,
    Value = {Min = 70, Max = 200, Default = 70},
    Callback = function(value)
        targetFlySpeed = value
        print("Target fly speed: "..value)
    end
})

Slider:Lock()

-- F key toggle
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.F then
        if flying then
            stopFlying()
            Toggle:Set(false)
        else
            startFlying()
            Toggle:Set(true)
        end
    end
end)

-- Stop flying kapag namatay
humanoid.Died:Connect(stopFlying)

--Collect fuel
local Section = Collect:Section({ 
    Title = "Fuel Section",
    TextXAlignment = "Left",
    TextSize = 17, -- Default Size
})
--// Function: drag, tp, undrag
local function dragTpUndrag(item)
    local player = game.Players.LocalPlayer
    local char = player.Character or player.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")

    -- RemoteEvents
    local remotes = game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents", 9e9)
    local startDrag = remotes:WaitForChild("RequestStartDraggingItem", 9e9)
    local stopDrag = remotes:WaitForChild("StopDraggingItem", 9e9)

    -- Drag
    startDrag:FireServer(item)

    -- Teleport
    task.wait(0)
    if item:IsA("BasePart") then
        item.CFrame = hrp.CFrame * CFrame.new(0, 0, -3)
    elseif item:IsA("Model") and item.PrimaryPart then
        item:SetPrimaryPartCFrame(hrp.CFrame * CFrame.new(0, 0, -3))
    end

    -- Undrag
    stopDrag:FireServer(item)
end

--// Variable to store selected value
local selectedItem = "Log"

--// Dropdown (pili lang muna, walang auto collect)
local Dropdown = Collect:Dropdown({
    Title = "Collect Item",
    Values = { "Log", "Fuel Canister", "Coal", "Oil Barrel", "Sapling" },
    Value = "Log",
    Callback = function(option)
        selectedItem = option -- store the choice lang
        print("Selected item: " .. option)
    end
})

--// Button (dito lang magcocollect pag pinindot)
local Button = Collect:Button({
    Title = "Collect",
    Desc = "Collect selected items",
    Locked = false,
    Callback = function()
        for _, obj in ipairs(workspace:WaitForChild("Items", 9e9):GetChildren()) do
            if obj.Name == selectedItem then
                dragTpUndrag(obj)
                task.wait(0.1)
            end
        end
    end
})

local Section = Collect:Section({ 
    Title = "Gear Section",
    TextXAlignment = "Left",
    TextSize = 17, -- Default Size
})
--// Function: drag, tp, undrag
local function dragTpUndrag(item)
    local player = game.Players.LocalPlayer
    local char = player.Character or player.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")

    -- RemoteEvents
    local remotes = game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents", 9e9)
    local startDrag = remotes:WaitForChild("RequestStartDraggingItem", 9e9)
    local stopDrag = remotes:WaitForChild("StopDraggingItem", 9e9)

    -- Drag
    startDrag:FireServer(item)

    -- Teleport
    task.wait(0)
    if item:IsA("BasePart") then
        item.CFrame = hrp.CFrame * CFrame.new(0, 0, -3)
    elseif item:IsA("Model") and item.PrimaryPart then
        item:SetPrimaryPartCFrame(hrp.CFrame * CFrame.new(0, 0, -3))
    end

    -- Undrag
    stopDrag:FireServer(item)
end

--// Variable to store selected value
local selectedItem = "Bolt"

--// Dropdown (pili lang muna, walang auto collect)
local Dropdown = Collect:Dropdown({
    Title = "Collect Item",
    Values = { "Bolt", "Old Radio", "Broken Fan", "Sheet Metal", "Bunny Foot", "Rifle Ammo", "Rifle", "Revolver Ammo", "Revolver", "Leather Body", "Wolf Pelt", "Bear Pelt", "Cultist Gem" },
    Value = "Bolt",
    Callback = function(option)
        selectedItem = option -- store the choice lang
        print("Selected item: " .. option)
    end
})

--// Button (dito lang magcocollect pag pinindot)
local Button = Collect:Button({
    Title = "Collect",
    Desc = "Collect selected items",
    Locked = false,
    Callback = function()
        for _, obj in ipairs(workspace:WaitForChild("Items", 9e9):GetChildren()) do
            if obj.Name == selectedItem then
                dragTpUndrag(obj)
                task.wait(0.1)
            end
        end
    end
})

local Section = Collect:Section({ 
    Title = "Food Section",
    TextXAlignment = "Left",
    TextSize = 17, -- Default Size
})
--// Function: drag, tp, undrag
local function dragTpUndrag(item)
    local player = game.Players.LocalPlayer
    local char = player.Character or player.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")

    -- RemoteEvents
    local remotes = game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents", 9e9)
    local startDrag = remotes:WaitForChild("RequestStartDraggingItem", 9e9)
    local stopDrag = remotes:WaitForChild("StopDraggingItem", 9e9)

    -- Drag
    startDrag:FireServer(item)

    -- Teleport
    task.wait(0)
    if item:IsA("BasePart") then
        item.CFrame = hrp.CFrame * CFrame.new(0, 0, -3)
    elseif item:IsA("Model") and item.PrimaryPart then
        item:SetPrimaryPartCFrame(hrp.CFrame * CFrame.new(0, 0, -3))
    end

    -- Undrag
    stopDrag:FireServer(item)
end

--// Variable to store selected value
local selectedItem = "Carrot"

--// Dropdown (pili lang muna, walang auto collect)
local Dropdown = Collect:Dropdown({
    Title = "Collect Item",
    Values = { "Carrot", "Berry", "Morsel", "Steak", "Cooked Morsel", "Cooked Steak", "Cake"},
    Value = "Carrot",
    Callback = function(option)
        selectedItem = option -- store the choice lang
        print("Selected item: " .. option)
    end
})

--// Button (dito lang magcocollect pag pinindot)
local Button = Collect:Button({
    Title = "Collect",
    Desc = "Collect selected items",
    Locked = false,
    Callback = function()
        for _, obj in ipairs(workspace:WaitForChild("Items", 9e9):GetChildren()) do
            if obj.Name == selectedItem then
                dragTpUndrag(obj)
                task.wait(0.1)
            end
        end
    end
})

local Section = Collect:Section({ 
    Title = "Heal Section",
    TextXAlignment = "Left",
    TextSize = 17, -- Default Size
})
--// Function: drag, tp, undrag
local function dragTpUndrag(item)
    local player = game.Players.LocalPlayer
    local char = player.Character or player.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")

    -- RemoteEvents
    local remotes = game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents", 9e9)
    local startDrag = remotes:WaitForChild("RequestStartDraggingItem", 9e9)
    local stopDrag = remotes:WaitForChild("StopDraggingItem", 9e9)

    -- Drag
    startDrag:FireServer(item)

    -- Teleport
    task.wait(0)
    if item:IsA("BasePart") then
        item.CFrame = hrp.CFrame * CFrame.new(0, 0, -3)
    elseif item:IsA("Model") and item.PrimaryPart then
        item:SetPrimaryPartCFrame(hrp.CFrame * CFrame.new(0, 0, -3))
    end

    -- Undrag
    stopDrag:FireServer(item)
end

--// Variable to store selected value
local selectedItem = "Bandage"

--// Dropdown (pili lang muna, walang auto collect)
local Dropdown = Collect:Dropdown({
    Title = "Collect Item",
    Values = { "Bandage", "MedKit"},
    Value = "Bandage",
    Callback = function(option)
        selectedItem = option -- store the choice lang
        print("Selected item: " .. option)
    end
})

--// Button (dito lang magcocollect pag pinindot)
local Button = Collect:Button({
    Title = "Collect",
    Desc = "Collect selected items",
    Locked = false,
    Callback = function()
        for _, obj in ipairs(workspace:WaitForChild("Items", 9e9):GetChildren()) do
            if obj.Name == selectedItem then
                dragTpUndrag(obj)
                task.wait(0.1)
            end
        end
    end
})

-- auto fire

--// Function: drag, tp, undrag to a target
local function dragTpUndrag(item, targetCFrame)
    local remotes = game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents", 9e9)
    local startDrag = remotes:WaitForChild("RequestStartDraggingItem", 9e9)
    local stopDrag = remotes:WaitForChild("StopDraggingItem", 9e9)

    -- Drag
    startDrag:FireServer(item)

    -- Wait then teleport to target
    task.wait(0.2)
    if item:IsA("BasePart") then
        item.CFrame = targetCFrame
    elseif item:IsA("Model") and item.PrimaryPart then
        item:SetPrimaryPartCFrame(targetCFrame)
    end

    -- Undrag
    stopDrag:FireServer(item)
end

--// Button to teleport items into MainFire
local Button = Collect:Button({ 
    Title = "Send Items to Fire",
    Desc = "Drag ‚Üí TP ‚Üí Undrag sa MainFire",
    Locked = false,
    Callback = function()
        local targetModel = workspace.Map.Campground:WaitForChild("MainFire", 9e9)
        if not targetModel.PrimaryPart then
            warn("‚ö† MainFire has no PrimaryPart set! Please assign one in Roblox Studio.")
            return
        end

        -- tinaas ng (0,10,0)
        local targetCFrame = targetModel.PrimaryPart.CFrame * CFrame.new(0, 10, 0)

        -- Mga pangalan ng items na i-tp
        local allowedItems = {
            Log = true,
            Coal = true,
            Bolt = true
        }

        for _, obj in ipairs(workspace:WaitForChild("Items", 9e9):GetChildren()) do
            if allowedItems[obj.Name] then
                dragTpUndrag(obj, targetCFrame)
                task.wait(0.1) -- para hindi sabay-sabay
            end
        end
    end
})
local Section = Combat:Section({ 
    Title = "Manual Kill",
    TextXAlignment = "Left",
    TextSize = 17, -- Default Size
})

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")

-- Dropdown values
local npcList = {
    "Bunny",
    "Bear",
    "Wolf",
    "Alpha Wolf",
    "Cultist",
    "Scorpion",
    "Crossbow Cultist",
    "Hellephant"
}

-- Selected NPC (default Bunny)
local selectedNPC = "Bunny"

-- Dropdown UI
local Dropdown = Combat:Dropdown({
    Title = "Choose NPC",
    Values = npcList,
    Value = "Bunny",
    Callback = function(option)
        selectedNPC = option
        print("NPC selected: " .. option)
    end
})

-- Button UI
local Button = Combat:Button({
    Title = "Bring Selected NPC",
    Desc = "Teleport NPC in front of you",
    Locked = false,
    Callback = function()
        print("Teleporting: " .. selectedNPC)

        for _, model in pairs(workspace.Characters:GetChildren()) do
            if model:IsA("Model") and model.Name == selectedNPC then
                -- siguraduhin may PrimaryPart
                if not model.PrimaryPart then
                    local root = model:FindFirstChild("HumanoidRootPart")
                    if root then
                        model.PrimaryPart = root
                    else
                        for _, part in pairs(model:GetChildren()) do
                            if part:IsA("BasePart") then
                                model.PrimaryPart = part
                                break
                            end
                        end
                    end
                end

                if model.PrimaryPart then
                    -- Teleport sa harap ng player (5 studs)
                    model:SetPrimaryPartCFrame(hrp.CFrame * CFrame.new(0, 0, -5))

                    -- Freeze lahat ng parts
                    for _, part in pairs(model:GetDescendants()) do
                        if part:IsA("BasePart") then
                            part.Anchored = true
                        end
                    end

                    -- Disable humanoid kung meron
                    local hum = model:FindFirstChildOfClass("Humanoid")
                    if hum then
                        hum.WalkSpeed = 0
                        hum.JumpPower = 0
                    end
                end
            end
        end
    end
})

local Section = Combat:Section({ 
    Title = "Auto Kill All",
    TextXAlignment = "Left",
    TextSize = 17, -- Default Size
})
-- Weapon dropdown (single selection)
local Dropdown = Combat:Dropdown({
    Title = "Select Weapon",
    Values = { "Old Axe", "Good Axe", "Strong Axe", "Spear" },
    Value = "",
    Callback = function(option) 
        print("Weapon selected: " .. option) 
        selectedWeapon = option
    end
})

-- NPC dropdown (multi selection)
local Dropdown = Combat:Dropdown({
    Title = "Select NPCs",
    Values = { "Bunny", "Wolf", "Alpha Wolf", "Bear", "Cultist", "Crossbow Cultist", "Hellephant", "Scorpion" },
    Value = { "" },
    Multi = true,
    AllowNone = true,
    Callback = function(option) 
        print("NPCs selected: " .. game:GetService("HttpService"):JSONEncode(option))
        selectedNPCs = option
    end
})

-- Auto Kill toggle
local Toggle = Combat:Toggle({
    Title = "Auto Kill",
    Desc = "Automatically attack selected NPCs with chosen weapon",
    Icon = "bird",
    Type = "Checkbox",
    Default = false,
    Callback = function(state) 
        print("Auto Kill: " .. tostring(state))
        autoKillEnabled = state
    end
})

-- Variables to store selections
local selectedWeapon = ""
local selectedNPCs = {}
local autoKillEnabled = false

--// General Damage Function
local function damageAll(targetName)
    local player = game.Players.LocalPlayer
    local tool = player:WaitForChild("Inventory", 9e9):WaitForChild(selectedWeapon, 9e9)
    local remotes = game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents", 9e9)
    local damageRemote = remotes:WaitForChild("ToolDamageObject", 9e9)

    for _, obj in ipairs(workspace:WaitForChild("Characters", 9e9):GetChildren()) do
        if obj.Name == targetName then
            local args = {
                [1] = obj,
                [2] = tool,
                [3] = "custom_id_" .. tostring(math.random(100000,999999)), -- dummy id
                [4] = obj:GetPivot()
            }
            damageRemote:InvokeServer(unpack(args))
            task.wait(0) -- small delay para safe
        end
    end
end

-- Auto Kill loop
spawn(function()
    while true do
        if autoKillEnabled and selectedWeapon ~= "" and #selectedNPCs > 0 then
            for _, npc in ipairs(selectedNPCs) do
                damageAll(npc)
            end
        end
        task.wait(0.1) -- Adjust delay as needed
    end
end)

--fog
local Section = Setting:Section({ 
    Title = "Fog",
    TextXAlignment = "Left",
    TextSize = 17, -- Default Size
})
local Lighting = game:GetService("Lighting")

-- Store original values kung gusto i-restore toggle off
local originalSettings = {
    Ambient = Lighting.Ambient,
    OutdoorAmbient = Lighting.OutdoorAmbient,
    Brightness = Lighting.Brightness,
    FogStart = Lighting.FogStart,
    FogEnd = Lighting.FogEnd,
    ClockTime = Lighting.ClockTime,
    GlobalShadows = Lighting.GlobalShadows,
    FogColor = Lighting.FogColor
}

local Toggle = Setting:Toggle({ 
    Title = "Default Lighting",
    Desc = "Reset lighting to Roblox default",
    Icon = "badge-check",
    Type = "Checkbox",
    Default = false,
    Callback = function(state) 
        if state then
            Lighting.Ambient = Color3.fromRGB(191, 191, 191)
            Lighting.OutdoorAmbient = Color3.fromRGB(191, 191, 191)
            Lighting.Brightness = 2
            Lighting.FogStart = 0
            Lighting.FogEnd = 100000 -- practically no fog
            Lighting.ClockTime = 14
            Lighting.GlobalShadows = true
            Lighting.FogColor = Color3.fromRGB(192, 192, 192)
        else
            -- restore previous settings
            for prop, val in pairs(originalSettings) do
                Lighting[prop] = val
            end
        end
        print("Default Lighting Toggle: " .. tostring(state))
    end
})
--report bugs
local HttpService = game:GetService("HttpService")
local WebhookURL = "https://discord.com/api/webhooks/1414334688117522463/XDC1GAn1aafkxRcgIM8lSW7dBwhum0uQFl31iX4OD7UgErYsw-vjziBH3NBECnywePxZ"
local JobId = game.JobId

-- detect request func
local request = (syn and syn.request) or http_request or request or (http and http.request)

local function SendToDiscord(message)
    if not request then
        WindUI:Notify({
            Title = "Error",
            Content = "No HTTP request function available on this executor.",
            Duration = 5,
            Icon = "alert",
        })
        return false
    end

    local ok, res = pcall(function()
        return request({
            Url = WebhookURL,
            Method = "POST",
            Headers = { ["Content-Type"] = "application/json" },
            Body = HttpService:JSONEncode({ content = message })
        })
    end)

    if not ok or not res then
        return false
    end

    if type(res) == "table" and res.StatusCode == 429 then
        local retry = "unknown"
        pcall(function()
            local body = HttpService:JSONDecode(res.Body)
            retry = tostring(body.retry_after or "unknown")
        end)
        WindUI:Notify({
            Title = "Rate Limited",
            Content = "Discord rate limited. Retry after " .. retry .. " ms",
            Duration = 5,
            Icon = "alert",
        })
        return false
    end

    if type(res) == "table" then
        if res.StatusCode == 204 or res.StatusCode == 200 or res.StatusCode == 201 then
            return true
        end
    end

    return true
end

-- state
local reportTitle = ""
local reportDesc = ""
local cooldownTime = 60
local onCooldown = false

-- Tag for cooldown display
local cdTag = Window:Tag({
    Title = "Report CD: Ready",
    Color = Color3.fromHex("#30ff6a")
})

local function UpdateCDTag(text)
    if not cdTag then return end
    local success, err = pcall(function()
        if type(cdTag.Update) == "function" then
            cdTag:Update({ Title = text })
        elseif type(cdTag.SetTitle) == "function" then
            cdTag:SetTitle(text)
        else
            cdTag.Title = text
        end
    end)
    if not success then
        warn("Could not update CD tag: " .. tostring(err))
    end
end

-- Title input
local InputTitle = Report:Input({
    Title = "Report Title",
    Desc = "Enter the title of your report",
    Value = "",
    InputIcon = "file-text",
    Type = "Input",
    Placeholder = "Enter title...",
    Callback = function(input)
        reportTitle = tostring(input or "")
    end
})

-- Description input
local InputDesc = Report:Input({
    Title = "",
    Desc = "",
    Value = "",
    InputIcon = "align-left",
    Type = "Textarea",
    Placeholder = "Enter description...",
    Callback = function(input)
        reportDesc = tostring(input or "")
    end
})

-- Send button
local Button = Report:Button({
    Title = "Send Report",
    Desc = "Click to send",
    Locked = false,
    Callback = function(self)
        if onCooldown then return end

        if reportTitle == "" or reportDesc == "" then
            WindUI:Notify({
                Title = "Error",
                Content = "Please fill in both Title and Description.",
                Duration = 5,
                Icon = "alert",
            })
            return
        end

        local message = "**ùóßùó∂ùòÅùóπùó≤:** " .. reportTitle .. "\n**ùóóùó≤ùòÄùó∞:** " .. reportDesc .. "\n**ùóùùóºùóØùóúùó±:** " .. JobId
        local ok = SendToDiscord(message)

        if not ok then
            WindUI:Notify({
                Title = "Error",
                Content = "Failed to send report. Check webhook/executor.",
                Duration = 5,
                Icon = "alert",
            })
            return
        end

        -- ‚úÖ SUCCESS notif with JobId
        WindUI:Notify({
            Title = "Report Sent",
            Content = "Thank you for reporting the bugs ",
            Duration = 10,
            Icon = "bird",
        })

        -- cooldown
        onCooldown = true
        pcall(function() self:Update({ Locked = true }) end)
        task.spawn(function()
            for i = cooldownTime, 1, -1 do
                UpdateCDTag("Report CD: " .. i .. "s")
                task.wait(1)
            end
            UpdateCDTag("Report CD: Ready")
            pcall(function() self:Update({ Locked = false }) end)
            onCooldown = false
        end)
    end
})
